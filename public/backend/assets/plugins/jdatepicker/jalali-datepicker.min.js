/** 
 * jQuery Jalali Date Picker Plugin | v1.0.2 (https://github.com/Rmanaf/jalali-datepicker) 
 * Licensed under MIT (https://github.com/Rmanaf/jalali-datepicker/blob/main/LICENSE) 
 */
(t=>{window.jdatepicker||(window.jdatepicker={}),t.fn.jdatepicker=function(e){var a=moment(),o={date:moment(),format:"jYYYY/jM/jD",lang:"fa",theme:"default",events:["click"],container:"body",prevMonthText:"قبل",nextMonthText:"بعد",dayNames:["ش","ی","د","س","چ","پ","ج"],monthNames:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],yearRange:[parseInt(a.format("jYYYY"))-100,parseInt(a.format("jYYYY"))+20],placement:"bottom",weekend:[6],theme:{},target:null,targetFormat:"YYYY-MM-DD hh:mm:ss",minWidth:"260px",fullWidth:!1,footer:!0,today:!0,year:!0,month:!0,dayOfWeek:t=>(t>5?t-=5:t+=2,t-=1,t),filterDigits:t=>{const e=["۰","۱","۲","۳","۴","۵","۶","۷","۸","۹"];var a="";for(t=String(t),i=0;i<t.length;i++)t[i]>="0"&&t[i]<="9"?a+=e[parseInt(t.charAt(i))]:a+=t[i];return a},filterMonthName:t=>{const e=["Farvardin","Ordibehesht","Khordaad","Tir","Mordaad","Shahrivar","Mehr","Aabaan","Aazar","Dey","Bahman","Esfand"];var a=String(t);return e.forEach(t=>{a=a.replace(t,o.monthNames[e.indexOf(t)])}),a},beforeHeader:t=>"",afterHeader:t=>"",beforeFooter:t=>"",afterFooter:t=>""};return Object.keys(o.theme).forEach(t=>{o.theme[t]=["jdp-"+t].concat(o.theme[t])}),this.each(function(){var r,n,d,l=t(this),i={...o},m="jdp_"+Math.floor(Math.random()*Date.now()),s=!1,c={},f=l.data();for(var p in l.data())if(0===p.indexOf("jdp")){const t=p.replace("jdp","").replace(/^./,function(t){return t.toLowerCase()});c[t]=f[p],["date","yearRange"].indexOf(t)>=0&&(c[t]=Function("return "+c[t])())}t.extend(i,e,c);var h=i.date.clone(),g=i.comment||i.filterDigits(i.filterMonthName(a.format(i.format))),u=l[0].tagName.toLowerCase();if("select"===u){var v=function(){for(var e=Math.abs(i.yearRange[1]-i.yearRange[0]),a=0;a<(i.year?e+1:1);a++)for(var o=i.year?parseInt(i.yearRange[0])+a:parseInt(i.date.format("jYYYY")),r=0;r<(i.month?12:1);r++){var n=i.month?r+1:1,d=moment(o+"-"+n+"-1","jYYYY-jM-jD");l.append(t("<option>",{selected:i.date.format("jYYYY-jM")===d.format("jYYYY-jM"),value:d.format(i.targetFormat),text:i.filterDigits(i.filterMonthName(d.format(i.format)))}))}};return v(),void l.on("change",function(){l.trigger("jdp.change",[{date:moment(t(this).val(),i.targetFormat),value:l.find("option:selected").text(),format:i.format,target:l,targetFormat:i.targetFormat}])})}if("input"===u){var Y=function(t){r.is(t.target)||0!==r.has(t.target).length||_()},y=()=>{var e=i.date.clone();r=t(`<div id="${m}" class="${x("container")}"></div>`),n=t(`<div class="${x("header")}">`+i.beforeHeader(e)+`<div class="${x("headerWrap")}" role="group">\n                                <select id="${m}_month_select" class="${x("select")}"></select>`+(i.year?`<select id="${m}_year_select" class="${x("select")}"></select>`:"")+"</div>"+i.afterHeader(e)+"</div>"),_footer=t(`<div class="${x("footer")}">`+i.beforeFooter(e)+`<div class="${x("footerWrap")}" role="group">\n                                <button type="button" id="${m}_prev_btn" class="${x("prev")}">${i.prevMonthText}</button>`+(i.today?`<button type="button" id="${m}_cmt_btn" class="${x("day")}">${g}</button>`:"")+`<button type="button" id="${m}_next_btn" class="${x("next")}">${i.nextMonthText}</button>\n                            </div>`+i.afterFooter(e)+"</div>"),d=t(`<div class="${x("body")}"></div>`),r.append(n,d),i.footer&&r.append(_footer),l.on("click",t=>{b()}),M(i.date),s=!0},b=e=>{s&&(t(i.container).append(r),t("#"+m+"_prev_btn").on("click",t=>{i.date=moment(i.date).subtract(1,"month"),j(),w()}),t("#"+m+"_next_btn").on("click",t=>{i.date=i.date.clone().add(1,"month"),j(),w()}),t("#"+m+"_cmt_btn").on("click",t=>{M(a.clone()),j(),w()}),t("#"+m+"_month_select").on("change",e=>{let a=i.date.format("jM")-1,o=t("#"+m+"_month_select").val()-a;0!=o&&(i.date=o>0?i.date.clone().add(o,"month"):i.date.clone().subtract(Math.abs(o),"month")),j(),w()}),t("#"+m+"_year_select").on("change",e=>{let a=i.date.format("jYYYY"),o=t("#"+m+"_year_select").val()-a;0!=o&&(i.date=o>0?i.date.clone().add(o,"year"):i.date.clone().subtract(Math.abs(o),"year")),j(),w()}),j(),w(e),k(),t(document).on("mouseup",Y))},j=()=>{t("#"+m+"_month_select").empty(),t("#"+m+"_year_select").empty();for(var e=0;e<i.monthNames.length;e++){let a=t(`<option value="${e}">${i.monthNames[e]}</option>`);e+1==i.date.format("jM")&&a.attr("selected","selected"),t("#"+m+"_month_select").append(a)}for(e=i.yearRange[0];e<=i.yearRange[1];e++){let a=t(`<option value="${e}">\n                                ${i.filterDigits(e)}\n                            </option>`);e==i.date.format("jYYYY")&&a.attr("selected","selected"),t("#"+m+"_year_select").append(a)}},_=()=>{t(document).off("mouseup",Y),r.remove()},M=e=>{let a=i.filterDigits(i.filterMonthName(e.clone().format(i.format)));i.date=e,h=e.clone(),l.val(a),i.target&&t(i.target).val(e.clone().format(i.targetFormat)),l.trigger("jdp.change",[{date:e.clone(),value:a,format:i.format,target:i.target,targetFormat:i.targetFormat}])},$=e=>t(window).width()-(e.offset().left+e.outerWidth()),k=()=>{var t,e;"top"==i.placement?(t=l.offset().top-r.outerHeight(),e=$(l)):"bottom"==i.placement?(t=l.offset().top+l.outerHeight(),e=$(l)):"left"==i.placement?(t=l.offset().top,e=$(l)+r.outerWidth()):"right"==i.placement&&(t=l.offset().top,e=$(l)-l.outerWidth());let a={top:t,minWidth:i.minWidth,right:e};!i.fullWidth||"top"!=i.placement&&"bottom"!=i.placement||(a.width=l.outerWidth()),r.css(a)},x=t=>(i.theme[t]||[]).join(" "),w=e=>{void 0===e&&(e=i.date),d.empty();let o=moment.isMoment(e)?e:moment(e),r=o.clone().startOf("jMonth"),n=r.format("jM"),l=i.dayOfWeek(r.weekday()),m=t(`<table class="${x("table")}"><thead><tr class="${x("tableHead")}"></tr></thead><tbody></tbody></table>`),s=m.find("thead"),c=m.find("tbody"),f=s.find("tr");for(let t=0;t<7;t++)f.append(`<th scope="col" class="${x("tableHeadCell")}">\n                                    <span>${i.dayNames[t]}</span>\n                                </th>`);let p=t("<tr></tr>");for(let t=0;t<l;t++)p.append("<td></td>");c.append(p);for(let e=0;e<=35;e++){let o=t("<td></td>"),d=r.clone().add(e,"days"),l=d.format("jM");if(l!=n)break;let m=i.dayOfWeek(d.weekday());0==m&&e>0&&(p=t("<tr></tr>"),c.append(p));let s=t(`<span role="button" class="${x("number")}">\n                                ${i.filterDigits(d.jDate())}\n                            </span>`);s.on("click",t=>{M(d),_()}),i.weekend.indexOf(m)>-1?o.addClass(x("weekend")):d.isSame(a,"day")&&o.addClass(x("today")),d.format("jYYYY/jM/jD")==h.format("jYYYY/jM/jD")&&o.addClass(x("selected")),o.append(s),p.append(o)}d.append(m)};y()}else{var D=l.text().trim();D&&(D=moment(D,i.targetFormat).format(i.format),l.text(i.filterDigits(i.filterMonthName(D))))}})}})(jQuery);